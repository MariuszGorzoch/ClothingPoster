<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="yes" name="apple-mobile-web-app-capable" />
    <meta content="default" name="apple-mobile-web-app-status-bar-style" />
    <meta content="yes" name="mobile-web-app-capable" />
    <meta content="yes" name="apple-touch-fullscreen" />
    <meta content="Matematyczny Labirynt" name="apple-mobile-web-app-title" />
    <link href="manifest.webmanifest" rel="manifest" />
    <link href="MoniTTa.jpg" rel="apple-touch-icon" />
    <title>Matematyczny Labirynt</title>
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link href="layout.css" rel="stylesheet" />
  </head>
  <body class="labyrinth-page">
    <div class="labyrinth-shell">
      <header class="labyrinth-header">
        <div>
          <p class="labyrinth-eyebrow">Mnożenie i dzielenie w zakresie 0 - 30</p>
          <h1>Uzupełnij labirynt</h1>
          <p class="labyrinth-subtitle">
            Kliknij w puste pola i wpisz brakujące liczby tak, aby równania
            poziome i pionowe były prawdziwe.
          </p>
        </div>
      </header>
      <main class="labyrinth-main">
        <section class="labyrinth-board" aria-label="Labirynt matematyczny">
          <div class="labyrinth-grid" id="labyrinth-grid"></div>
        </section>
        <p class="labyrinth-hint">
          Wskazówka: w każdej kratce wpisz tylko liczbę od 0 do 30.
        </p>
      </main>
    </div>

    <script>
      const grid = Array.from({ length: 13 }, () => Array(13).fill(null));

      const setCell = (row, col, value) => {
        grid[row][col] = value;
      };

      setCell(1, 1, "10");
      setCell(1, 2, "•");
      setCell(1, 3, { answer: "3" });
      setCell(1, 4, "=");
      setCell(1, 5, "30");

      setCell(2, 1, "=");
      setCell(3, 1, "5");
      setCell(4, 1, "•");
      setCell(5, 1, "2");

      setCell(3, 3, "6");
      setCell(3, 4, "•");
      setCell(3, 5, { answer: "4" });
      setCell(3, 6, "=");
      setCell(3, 7, "24");

      setCell(4, 7, ":");
      setCell(5, 7, "6");
      setCell(6, 7, "=");
      setCell(7, 7, { answer: "4" });

      setCell(7, 4, "20");
      setCell(7, 5, "8");
      setCell(7, 6, "=");
      setCell(7, 8, "•");
      setCell(7, 9, "2");

      setCell(8, 4, ":");

      setCell(9, 2, "30");
      setCell(9, 3, ":");
      setCell(9, 4, { answer: "5" });
      setCell(9, 5, "=");
      setCell(9, 6, "6");

      setCell(10, 4, "=");
      setCell(11, 4, "4");

      setCell(8, 9, "•");
      setCell(9, 9, { answer: "3" });
      setCell(10, 9, "=");
      setCell(11, 9, "6");

      const gridElement = document.getElementById("labyrinth-grid");

      const sanitizeValue = (value) => value.replace(/\D/g, "").slice(0, 2);

      grid.forEach((row, rowIndex) => {
        row.forEach((cell, colIndex) => {
          const cellElement = document.createElement("div");
          cellElement.className = "labyrinth-cell";
          cellElement.style.gridRow = rowIndex + 1;
          cellElement.style.gridColumn = colIndex + 1;

          if (cell === null) {
            cellElement.classList.add("labyrinth-cell--empty");
          } else if (typeof cell === "object" && cell.answer) {
            cellElement.classList.add("labyrinth-cell--input");
            const input = document.createElement("input");
            input.type = "text";
            input.inputMode = "numeric";
            input.autocomplete = "off";
            input.setAttribute("aria-label", "Wpisz liczbę");
            input.dataset.answer = cell.answer;
            input.addEventListener("input", (event) => {
              const target = event.target;
              target.value = sanitizeValue(target.value);
              const isCorrect =
                target.value.length > 0 &&
                target.value === target.dataset.answer;
              cellElement.classList.toggle("labyrinth-cell--correct", isCorrect);
              cellElement.classList.toggle(
                "labyrinth-cell--incorrect",
                target.value.length > 0 && !isCorrect
              );
            });
            cellElement.appendChild(input);
          } else {
            cellElement.textContent = cell;
          }

          gridElement.appendChild(cellElement);
        });
      });
    </script>
  </body>
</html>
