<!DOCTYPE html>
<html lang="en"><head>
<meta charset="utf-8"/>
<title>Stitch Design</title>
<link href="data:image/x-icon;base64," rel="icon" type="image/x-icon"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect"/>
<link as="style" href="https://fonts.googleapis.com/css2?display=swap&amp;family=Manrope%3Awght%40400%3B500%3B700%3B800&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900" onload="this.rel='stylesheet'" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<script id="tailwind-config">
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            primary: "#1173d4",
            "background-light": "#f6f7f8",
            "background-dark": "#101922",
          },
          fontFamily: {
            display: ["Manrope"],
          },
          borderRadius: {
            DEFAULT: "0.25rem",
            lg: "0.5rem",
            xl: "0.75rem",
            full: "9999px"
          },
        },
      },
    };
  </script>
<style>
    .form-input {
      appearance: none;
      background-color: transparent;
      border-width: 0;
      padding: 0;
      margin: 0;
      box-sizing: border-box;
    }
    .form-input:focus {
      outline: none;
      box-shadow: none;
    }
  </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
  </head>
<body class="bg-background-light dark:bg-background-dark font-display">
<div class="flex flex-col min-h-screen">
<header class="sticky top-0 z-10 bg-background-light dark:bg-background-dark bg-opacity-80 dark:bg-opacity-80 backdrop-blur-sm">
<div class="w-full px-4">
  <div class="flex items-center justify-between py-4">
    <button class="p-2 text-primary" onclick="window.location.href='index.html';" type="button">
      <span class="material-symbols-outlined"> close </span>
    </button>
    <h1 class="text-lg font-bold text-black dark:text-white">Manage Product</h1>
    <div class="w-6"></div>
  </div>
</div>
</header>
<main class="flex-grow">
<div class="w-full px-4 py-6">
<div class="relative aspect-[3/4] w-full rounded-xl overflow-hidden mb-6">
<div class="absolute inset-0 flex overflow-x-auto snap-x snap-mandatory" id="image-slider"></div>
<div class="absolute bottom-4 left-1/2 -translate-x-1/2 flex space-x-2" id="image-indicators"></div>
</div>
<div class="space-y-4">
<div>
<label class="text-sm font-medium text-black/60 dark:text-white/60" for="product-title">Title</label>
<div class="mt-1 bg-white/5 dark:bg-white/5 rounded-lg border border-black/10 dark:border-white/10">
<input class="w-full h-12 px-4 bg-transparent text-black dark:text-white placeholder-black/40 dark:placeholder-white/40" id="product-title" placeholder="e.g. Classic Blue Jeans" type="text"/>
</div>
</div>
<div class="grid grid-cols-2 gap-4">
<div>
<label class="text-sm font-medium text-black/60 dark:text-white/60" for="category">Category</label>
<div class="mt-1 bg-white/5 dark:bg-white/5 rounded-lg border border-black/10 dark:border-white/10">
<input class="w-full h-12 px-4 bg-transparent text-black dark:text-white placeholder-black/40 dark:placeholder-white/40" id="category" placeholder="e.g. Jeans" type="text"/>
</div>
</div>
<div>
<label class="text-sm font-medium text-black/60 dark:text-white/60" for="brand">Brand</label>
<div class="mt-1 bg-white/5 dark:bg-white/5 rounded-lg border border-black/10 dark:border-white/10">
<input class="w-full h-12 px-4 bg-transparent text-black dark:text-white placeholder-black/40 dark:placeholder-white/40" id="brand" placeholder="e.g. Levi's" type="text"/>
</div>
</div>
</div>
<div class="grid grid-cols-2 gap-4">
<div>
<label class="text-sm font-medium text-black/60 dark:text-white/60" for="model">Model</label>
<div class="mt-1 bg-white/5 dark:bg-white/5 rounded-lg border border-black/10 dark:border-white/10">
<input class="w-full h-12 px-4 bg-transparent text-black dark:text-white placeholder-black/40 dark:placeholder-white/40" id="model" placeholder="e.g. 501" type="text"/>
</div>
</div>
<div>
<label class="text-sm font-medium text-black/60 dark:text-white/60" for="colors">Colors</label>
<div class="mt-1 bg-white/5 dark:bg-white/5 rounded-lg border border-black/10 dark:border-white/10">
<input class="w-full h-12 px-4 bg-transparent text-black dark:text-white placeholder-black/40 dark:placeholder-white/40" id="colors" placeholder="e.g. Blue, Indigo" type="text"/>
</div>
</div>
</div>
<div>
<label class="text-sm font-medium text-black/60 dark:text-white/60" for="materials">Materials</label>
<div class="mt-1 bg-white/5 dark:bg-white/5 rounded-lg border border-black/10 dark:border-white/10">
<input class="w-full h-12 px-4 bg-transparent text-black dark:text-white placeholder-black/40 dark:placeholder-white/40" id="materials" placeholder="e.g. Denim, Cotton" type="text"/>
</div>
</div>
<div class="grid grid-cols-2 gap-4">
<div>
<label class="text-sm font-medium text-black/60 dark:text-white/60" for="pattern">Pattern</label>
<div class="mt-1 bg-white/5 dark:bg-white/5 rounded-lg border border-black/10 dark:border-white/10">
<input class="w-full h-12 px-4 bg-transparent text-black dark:text-white placeholder-black/40 dark:placeholder-white/40" id="pattern" placeholder="e.g. Solid" type="text"/>
</div>
</div>
<div>
<label class="text-sm font-medium text-black/60 dark:text-white/60" for="condition">Condition</label>
<div class="mt-1 bg-white/5 dark:bg-white/5 rounded-lg border border-black/10 dark:border-white/10">
<input class="w-full h-12 px-4 bg-transparent text-black dark:text-white placeholder-black/40 dark:placeholder-white/40" id="condition" placeholder="e.g. Excellent" type="text"/>
</div>
</div>
</div>
<div class="grid grid-cols-2 gap-4">
<div>
<label class="text-sm font-medium text-black/60 dark:text-white/60" for="size-label">Size Label</label>
<div class="mt-1 bg-white/5 dark:bg-white/5 rounded-lg border border-black/10 dark:border-white/10">
<input class="w-full h-12 px-4 bg-transparent text-black dark:text-white placeholder-black/40 dark:placeholder-white/40" id="size-label" placeholder="e.g. M, 32x32" type="text"/>
</div>
</div>
<div>
<label class="text-sm font-medium text-black/60 dark:text-white/60" for="fit">Fit</label>
<div class="mt-1 bg-white/5 dark:bg-white/5 rounded-lg border border-black/10 dark:border-white/10">
<input class="w-full h-12 px-4 bg-transparent text-black dark:text-white placeholder-black/40 dark:placeholder-white/40" id="fit" placeholder="e.g. Straight Leg" type="text"/>
</div>
</div>
</div>
<div>
<label class="text-sm font-medium text-black/60 dark:text-white/60">Measurements (cm)</label>
<div class="grid grid-cols-3 gap-2 mt-1">
<div>
<input class="w-full h-12 px-3 bg-white/5 dark:bg-white/5 rounded-lg border border-black/10 dark:border-white/10 text-black dark:text-white placeholder-black/40 dark:placeholder-white/40" id="measurement-chest" placeholder="Chest" type="number"/>
</div>
<div>
<input class="w-full h-12 px-3 bg-white/5 dark:bg-white/5 rounded-lg border border-black/10 dark:border-white/10 text-black dark:text-white placeholder-black/40 dark:placeholder-white/40" id="measurement-waist" placeholder="Waist" type="number"/>
</div>
<div>
<input class="w-full h-12 px-3 bg-white/5 dark:bg-white/5 rounded-lg border border-black/10 dark:border-white/10 text-black dark:text-white placeholder-black/40 dark:placeholder-white/40" id="measurement-hip" placeholder="Hip" type="number"/>
</div>
<div>
<input class="w-full h-12 px-3 bg-white/5 dark:bg-white/5 rounded-lg border border-black/10 dark:border-white/10 text-black dark:text-white placeholder-black/40 dark:placeholder-white/40" id="measurement-length" placeholder="Length" type="number"/>
</div>
<div>
<input class="w-full h-12 px-3 bg-white/5 dark:bg-white/5 rounded-lg border border-black/10 dark:border-white/10 text-black dark:text-white placeholder-black/40 dark:placeholder-white/40" id="measurement-sleeve" placeholder="Sleeve" type="number"/>
</div>
<div>
<input class="w-full h-12 px-3 bg-white/5 dark:bg-white/5 rounded-lg border border-black/10 dark:border-white/10 text-black dark:text-white placeholder-black/40 dark:placeholder-white/40" id="measurement-shoulder" placeholder="Shoulder" type="number"/>
</div>
</div>
</div>
<div>
<label class="text-sm font-medium text-black/60 dark:text-white/60" for="style">Style</label>
<div class="mt-1 bg-white/5 dark:bg-white/5 rounded-lg border border-black/10 dark:border-white/10">
<input class="w-full h-12 px-4 bg-transparent text-black dark:text-white placeholder-black/40 dark:placeholder-white/40" id="style" placeholder="e.g. Classic, Vintage" type="text"/>
</div>
</div>
<div>
<label class="text-sm font-medium text-black/60 dark:text-white/60" for="notable-details">Notable Details</label>
<div class="mt-1 bg-white/5 dark:bg-white/5 rounded-lg border border-black/10 dark:border-white/10">
<textarea class="w-full px-4 py-3 bg-transparent text-black dark:text-white placeholder-black/40 dark:placeholder-white/40 resize-none" id="notable-details" placeholder="e.g. Red tab, button fly" rows="2"></textarea>
</div>
</div>
<div>
<label class="text-sm font-medium text-black/60 dark:text-white/60" for="defects">Defects</label>
<div class="mt-1 bg-white/5 dark:bg-white/5 rounded-lg border border-black/10 dark:border-white/10">
<textarea class="w-full px-4 py-3 bg-transparent text-black dark:text-white placeholder-black/40 dark:placeholder-white/40 resize-none" id="defects" placeholder="e.g. Small fraying on cuff" rows="2"></textarea>
</div>
</div>
</div>
</div>
</main>
<footer class="sticky bottom-0 bg-background-light dark:bg-background-dark bg-opacity-80 dark:bg-opacity-80 backdrop-blur-sm py-4">
<div class="w-full px-4">
<div class="space-y-3">
<button class="w-full h-12 bg-primary text-white font-bold rounded-lg text-base">Save Changes</button>
<button class="w-full h-12 bg-primary/20 dark:bg-primary/30 text-primary font-bold rounded-lg text-base">Create Facebook Post</button>
<button class="w-full h-12 bg-transparent text-red-500 font-bold rounded-lg text-base">Delete Product</button>
</div>
</div>
</footer>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const slider = document.getElementById('image-slider');
    const indicators = document.getElementById('image-indicators');
    const params = new URLSearchParams(window.location.search);
    const productId = params.get('productId');

    if (!productId) {
      console.warn('No productId provided in the query string.');
      return;
    }

    fetchProduct(productId);

    async function fetchProduct(id) {
      try {
        const response = await fetch(`https://localhost:7168/products/${encodeURIComponent(id)}`);

        if (!response.ok) {
          throw new Error(`Failed to fetch product. Status: ${response.status}`);
        }

        const product = await response.json();
        populateFields(product);
        populateImages(Array.isArray(product?.Images) ? product.Images : []);
      } catch (error) {
        console.error('Unable to load product details.', error);
        populateImages([]);
      }
    }

    function populateFields(product) {
      const attributes = product?.Attributes ?? {};

      const fieldMap = {
        'product-title': attributes.Title,
        category: attributes.Category,
        brand: attributes.Brand,
        model: attributes.Model,
        colors: attributes.Colors,
        materials: attributes.Materials,
        pattern: attributes.Pattern,
        condition: attributes.Condition,
        'size-label': attributes.SizeLabel,
        fit: attributes.Fit,
        style: attributes.Style,
      };

      Object.entries(fieldMap).forEach(([id, value]) => {
        const element = document.getElementById(id);

        if (element) {
          element.value = value ?? '';
        }
      });

      const measurements = {
        'measurement-chest': attributes.ChestCm,
        'measurement-waist': attributes.WaistCm,
        'measurement-hip': attributes.HipCm,
        'measurement-length': attributes.LengthCm,
        'measurement-sleeve': attributes.SleeveCm,
        'measurement-shoulder': attributes.ShoulderCm,
      };

      Object.entries(measurements).forEach(([id, value]) => {
        const element = document.getElementById(id);

        if (element) {
          element.value = value ?? '';
        }
      });

      const notableDetails = document.getElementById('notable-details');
      const defects = document.getElementById('defects');

      if (notableDetails) {
        notableDetails.value = attributes.NotableDetails ?? '';
      }

      if (defects) {
        defects.value = attributes.Defects ?? '';
      }
    }

    function populateImages(images) {
      if (!slider || !indicators) {
        return;
      }

      slider.innerHTML = '';
      indicators.innerHTML = '';

      if (!images.length) {
        const placeholder = document.createElement('div');
        placeholder.className = 'flex-shrink-0 w-full h-full snap-center bg-background-light dark:bg-background-dark flex items-center justify-center text-black/60 dark:text-white/60';
        placeholder.textContent = 'No images available';
        slider.appendChild(placeholder);
        return;
      }

      images.forEach((url, index) => {
        const slide = document.createElement('div');
        slide.className = 'flex-shrink-0 w-full h-full snap-center bg-cover bg-center';
        slide.style.backgroundImage = `url("${url}")`;
        slider.appendChild(slide);

        const indicator = document.createElement('div');
        indicator.className = `w-2 h-2 rounded-full ${index === 0 ? 'bg-white' : 'bg-white/50'}`;
        indicators.appendChild(indicator);
      });

      slider.scrollTo({ left: 0 });
      updateIndicators();
      slider.addEventListener('scroll', handleSliderScroll, { passive: true });
    }

    let scrollTicking = false;

    function handleSliderScroll() {
      if (!scrollTicking) {
        scrollTicking = true;
        window.requestAnimationFrame(() => {
          updateIndicators();
          scrollTicking = false;
        });
      }
    }

    function updateIndicators() {
      if (!slider || !indicators || !indicators.children.length) {
        return;
      }

      const slideWidth = slider.clientWidth || 1;
      const activeIndex = Math.round((slider.scrollLeft || 0) / slideWidth);

      Array.from(indicators.children).forEach((indicator, index) => {
        indicator.className = `w-2 h-2 rounded-full ${index === activeIndex ? 'bg-white' : 'bg-white/50'}`;
      });
    }
  });
</script>

</body>
</html>
